---
title: "Comparing the Effectiveness of VR-Based and CBT Interventions for Autism Spectrum
  Disorder"
author: "Brendan Flaherty (D00285274) & Jeremiah Spillane (D00295490)"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: true
  html_notebook:
    toc: true
  html_document:
    toc: true
    code_folding: hide
    df_print: paged
---

# Data Analytics for Immersive Environments (COMPC9047)

## Investigating the Impact of Therapeutic Interventions on Austistic Traits using the Autism Spectrum Quotient (AQ)

**Participants:** Brendan Flaherty (D00285274) & Jeremiah Spillane (D00295490) **Module:** Data Analytics for Immersive Environments (COMPC9047) **Date:** `r Sys.Date()`

------------------------------------------------------------------------

# Abstract 
## Aim and rationale 

This research paper examines changes in Autism Spectrum Quotient (AQ) scores across two parameters. Firstly across time, that is pre-trial and post trial over a 12 week period, and secondly, across three groups employing various approaches. These groups employ different approaches, namely 1) cognitive behavioral therapy (CBT) ; 2) virtual reality (VR) and 3) a control group. This study aims to answer whether CBT or VR-based therapy lead to a statistically significant change in AQ scores compared to no treatment, and whether or not one intervention is more effective than the other.


## Participants and setting 

The study involved a total of 300 adult participants (150 male, 150 female) aged between 12 and 40 years. Participants were randomly sampled from a clinical population and randomly assigned to one of three equal sized groups: a Cognitive Behavioral Therapy (CBT) group, a Virtual Reality (VR) therapy group, and a control group receiving no intervention. Gender was recorded for all participants.

## Experiment design 

This study employed a randomised controlled, pre-test/post-test, mixed experimental design to examine the effectiveness of therapeutic interventions on autistic traits over time (t = 12 weeks).


## Results gathering

Results were gathered by comparing pre- and post-treatment Autism Spectrum Quotient (AQ) scores across participants using inferential statistical tests, including paired t-tests, between groun t-tests, and z-tests, alongside descriptive statistics and 95% confidence intervals to quantify change over the 12-week period. This approach assessed whether observed changes in AQ scores were statistically significant and unlikely to have occurred by chance


## Findings/implications

The findings indicated a statistically significant reduction in AQ scores, suggesting that therapeutic intervention was associated with measurable changes in reported autistic traits across the sample. However, the implications are constrained by reliance on self-report data and the need to interpret statistical significance cautiously when considering real-world or clinical impact.

# Introduction

## Topic and Context

As defined by the World Health Organisation (WHO) "Autism spectrum disorders (ASD) are a diverse group of conditions. They are characterized by some degree of difficulty with social interaction and communication. Other characteristics are atypical patterns of activities and behaviors, such as difficulty with transition from one activity to another, a focus on details and unusual reactions to sensations". It has been suggested that "it has been suggested that Cognitive Behavior Therapy (CBT) is beneficial to people with Autism Spectrum Disorder (ASD) but that the method needs to be modified in relation to their cognitive profile" (Ekman E., et al., 2015). Virtual reality (VR) too has been proposed to support those with ASD in educational settings, with emotional regulation (Herrero, J.F. et al., 2025). 


## Rationale

This research paper examines changes in Autism Spectrum Quotient (AQ) scores across two parameters. Firstly across time, that is pre-trial and post trial over a 12 week period, and secondly, across three groups employing various approaches. These groups employ different approaches, namely 1) cognitive behavioral therapy (CBT) ; 2) virtual reality (VR) and 3) a control group. This study aims to answer whether CBT or VR-based therapy lead to a statistically significant change in AQ scores compared to no treatment, and whether or not one intervention is more effective than the other.

## Hypotesis

#### **H1:** After controlling for baseline AQ, there will be no group differences in post-treatment (null-hypothesis)

#### **H2:** Both CBT abd VR therapy groups will show significant reductions in AQ scores from pre-treatment to post-treatment, while the control group will not

#### **H3:** The VR therapy group will show a statistically significantly greater reduction in AQ scores from pre-treatment to post-treatment than the CBT group.

# Method

#### **Participants:** 300 adults (M = 150, F = 150), aged 12-40. Random assignment to CBT (n = 100), VR (n = 100), Control (n = 100).

#### **Design:** Mixed 3 (Group: CBT, VR, Control - between subjects) x 2 (Time: Pre, Post - within-subjects) design.

#### **Materials:** Autism Spectrum Quotient (AQ) 50-item questionnaire, scored 0-50.1.

#### **Procedure:** Each participant completed AQ before and after 12 weeks of therapy.

-   CBT: Weekly sessions on social/emotional regulation.

-   VR: Immersive simulations for social interaction.

-   Control: No intervention.

Data recorded in columns P1_Pre_Score and P2_Post_Score.

# Results

### \*\*Data Cleaning\*

```{r Data Cleaning, message=TRUE, warning=TRUE, paged.print=FALSE}
# Adding librarys to notebook to run the code correctly
if(!require("tidyverse"))
  install.packages("tidyverse")
  library(tidyverse)

if(!require("ggpubr"))
  install.packages("ggpubr")
  library(ggpubr)

if(!require("rstatix"))
  install.packages("rstatix")
  library(rstatix)

if(!require("knitr"))
install.packages("knitr")
library(knitr)


# Read the data frames of the .csv file
df <- read_csv("CA1_Autism_VR_Study_Data_Final.csv")
# Check the column names
colnames(df)
# Change column names to lowercase
df <- df %>% rename_with(tolower) %>% mutate(group = str_trim(tolower(group)))
# Inspect Structure
glimpse(df)
summary(select(df, p1_pre_score, p2_post_score))
# Check for missing values
sapply(df, function(x) sum(is.na(x)))
# Check for values outside the scope of the questionnaire - 0 - 50.1
filter(df, p1_pre_score < 0 | p1_pre_score > 50.1 | p2_post_score < 0 | p2_post_score > 50.1)
# Drop incomplete rows
df <- df %>% drop_na(p1_pre_score, p2_post_score)
# Identify change_score (pre-post AQ)
df <- df %>% mutate(change_score = p1_pre_score - p2_post_score)
# Confirm groups
unique(df$group)
# Check for summary of all columns
summary(select(df, p1_pre_score, p2_post_score, change_score))
```

### **Descriptive Statistics**

#### **Plots**

```{r box plot, message=TRUE, warning=TRUE}
# BoxPlot created to show pre-treatment AQ scores
pre_box <- ggplot(df, aes(x = group, y = p1_pre_score, fill = group)) + geom_boxplot() + scale_fill_manual(values = c("skyblue", "lightgreen", "orange")) + labs(title = "Pre-Treatment AQ Scores",  x = "Group", y = "AQ Score (0–50)") + theme_minimal(base_size = 13) + theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# BoxPlot created to show post-treatment AQ scores
post_box <- ggplot(df, aes(x = group, y = p2_post_score, fill = group)) + geom_boxplot() + scale_fill_manual(values = c("skyblue", "lightgreen", "orange")) + labs(title = "Post-Treatment AQ Scores",  x = "Group", y = "AQ Score (0–50)") + theme_minimal(base_size = 13) + theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# Use ggpbr library to arrange histograms side-by-side to show difference pre and post treatment
library(ggpubr)
ggarrange(pre_box, post_box, ncol = 2, common.legend = TRUE, legend = "bottom")

# Pre-treatment AQ scores shows similar median. Post-Treatment AQ scores show VR Therapy group noticeably lower indicating greater improvement. Boxes show IQR and whiskers show outliers

```

```{r bar chart, message=TRUE, warning=TRUE}
# Summarise and group mean score data by group for creating bar chart
avg_dep_scores <- df %>% summarise(mean_pre = mean(p1_pre_score), mean_post = mean(p2_post_score), .by = group) %>% pivot_longer(cols = c(mean_pre, mean_post), names_to = "time", values_to = "mean_score") %>% mutate(time = recode(time, "mean_pre" = "Pre-Treatment", "mean_post" = "Post-Treatment"))

# Bar chart created to show mean AQ scores before and after treatment for each group
ggplot(avg_dep_scores, aes(x = group, y = mean_score, fill = time)) + geom_bar(stat = "identity", position = position_dodge()) + scale_fill_manual(values = c("orange", "skyblue")) + labs(title = "Average AQ (Depression) Scores by Group", x = "Therapy Group", y = "Mean AQ Score (0-50)" ) + theme_minimal(base_size = 13)

# Both CBT and VR Therapy groups show reduced mean AQ scores after treatment
```

```{r line-graph, message=TRUE, warning=TRUE}
# Summarise and group mean score data by time for creating line graph
avg_dep_time <- df %>% summarise(mean_pre = mean(p1_pre_score), mean_post = mean(p2_post_score), .by = group) %>% pivot_longer(cols = c(mean_pre, mean_post), names_to = "time", values_to = "mean_score") %>% mutate(time = recode(time, "mean_pre" = "Pre-Treatment", "mean_post" = "Post-Treatment"))

# Line graph showing mean AQ scores for each group pre and post treatment
ggplot(avg_dep_time, aes(x = time, y = mean_score, group = group, color = group)) + geom_line(linewidth = 1.2) + geom_point(size = 13) + scale_colour_manual(values = c("orange", "skyblue", "lightgreen")) + labs(title = "Change in Mean AQ Scores Over Time by Group", x = "Time Point", y = "Mean AQ Score (0-50)" ) + theme_minimal(base_size = 13)

# Both CBT and VR Therapy groups downward trends from pre-treatment to post-treatment - VR Therapy shows greater reduction 
```

```{r histograms, message=TRUE, warning=TRUE}
# Calculate pre-treatment AQ score distributions across the 3 groups
pre_hist <- ggplot(df, aes(x = p1_pre_score, fill = group)) + geom_histogram(binwidth = 2, alpha = 0.6, position = "identity", color = "black") + geom_vline(data = df %>% group_by(group) %>% summarise(mean_pre = mean(p1_pre_score)), aes(xintercept = mean_pre, colour = group), linetype = "dashed", linewidth = 1) +scale_fill_manual(values = c("orange", "skyblue", "lightgreen")) + scale_colour_manual(values = c("orange", "skyblue", "lightgreen")) + labs(title = "Pre-Treatment AQ Score Distribution", x = "AQ Score (0 -50)", y = "Frequency") + theme_minimal(base_size = 13) + theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# Calculate post-treatment AQ score distributions across the 3 groups
post_hist <- ggplot(df, aes(x = p2_post_score, fill = group)) + geom_histogram(binwidth = 2, alpha = 0.7, colour = "black") + geom_vline(data = df %>% group_by(group) %>% summarise(mean_post = mean(p2_post_score)), aes(xintercept = mean_post, color = group), linetype = "dashed", linewidth = 1) + scale_fill_manual(values = c("orange", "skyblue", "lightgreen")) + scale_colour_manual(values = c("orange", "skyblue", "lightgreen")) + labs(title = "Post-Treatment AQ Score Distribution", x = "AQ Score (0-50)", y = "Frequency") + theme_minimal(base_size = 13) + theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# Use ggpbr library to arrange histograms side-by-side to show difference pre and post treatment
library(ggpubr)
ggarrange(pre_hist, post_hist, ncol = 2, common.legend = TRUE, legend = "bottom")

# All groups show similar AQ score pre-treatment. Post-treatment, both CBT and VR Therapy groups show lower AQ score indicating improvement
```

```{r scatterplot, message=TRUE, warning=TRUE}

# Scatterplot showing relationship between pre-treatment AQ scores and change in AQ scores post-treatment
ggplot(df, aes(x = p1_pre_score, y = change_score, colour = group)) + geom_point(size = 3, alpha = 0.7) + geom_smooth(method = "lm", se = FALSE, linetype = "dashed") + scale_colour_manual(values = c("orange", "skyblue", "lightgreen")) + labs(title = "Pre-Treatment AQ vs Change in Score", x = "Pre-Treatment AQ Score", y = "Change in AQ (Pre - Post, Positive = Improvement)" ) + theme_minimal()

# A positive change indicates improvement - Participants with higher pre-treatment AQ scores tended to have a larger improvement

```

### **Inferential Statistics**

```{r paired t-test, message=TRUE, warning=TRUE}
# Assign and filter by group
cbt <- df %>% filter(group == "cbt")
vr <- df %>% filter(group == "vr")
control <- df %>% filter (group == "control")

# t-test by group
t_cbt <- t.test(cbt$p1_pre_score, cbt$p2_post_score, paired = TRUE)
t_vr <- t.test(vr$p1_pre_score, vr$p2_post_score, paired = TRUE)
t_control <- t.test(control$p1_pre_score, control$p2_post_score, paired = TRUE)

# Output results of t-tests in list
list(CBT = t_cbt, VR = t_vr, CONTROL = t_control)

# Interpretation: 
# CBT - significant improvement: t=22.9, p<.001. Mean diff = 10.99. CI between 9.2-11
# VR - Very big improvement: t=37.6, p<.001. Mean diff = 18.62. CI between 17.6-19.6
# CONTROL - no significant change: t=1.59, p=0.115. Mean diff = 0.6. CI include 0 - no change

# Results suggest that both CBT and VR reduced AQ scores with VR Therapy having a significant impact
```

```{r Between group t-test, message=TRUE, warning=TRUE}
# Assign and filter by groups - VR & Control, CBT & Control, VR and CBT
vr_control <- df %>% filter(group %in% c("vr", "control"))
cbt_control <- df %>% filter(group %in% c("cbt", "control"))
vr_cbt <- df %>% filter(group %in% c("vr", "cbt"))

# t-test between groups - VR vs Control | CBT vs Control | VR vs CBT 
t_vr_control <- t.test(change_score ~ group, data = vr_control, var.equal = TRUE)
t_cbt_control <- t.test(change_score ~ group, data = cbt_control, var.equal = TRUE)
t_vr_cbt <- t.test(change_score ~ group, data = vr_cbt, var.equal = TRUE)

# Output results of between group t-tests in list
list(VR_vs_CONTROL = t_vr_control, CBT_vs_CONTROL = t_cbt_control, VR_vs_CBT = t_vr_cbt)

# Interpretation: 
# VR vs CONTROL - VR improves more than control: t=-28.95, p<.001. Mean improvement: VR = 18.62, Control = 0.6. CI between -19.25, -16.79. 18 point improvement 18.62 - 0.6
# CBT vs CONTROL - CBT improves more than control: t=16.35, p<.001. Mean improvement: CBT = 10.09, Control = 0.6. CI between 8.35, 10.63. 9/10 point improvement 10.09 - 0.6
# VR vs CBT - CBT improves more than control: t=-12.38, p<.001. Mean improvement: VR = 18.62, CBT = 10.09. CI between -9.84, -7.22. 7-10 point improvement 18.62 - 10.09

# Results suggest that both CBT and VR were a significant improvement on the Control group and comparing VR and CBT showed that the VR group achieved a larger improvement

```

```{r z-test, message=TRUE, warning=TRUE}
# Calculate the sample mean of change score
mean_change <- mean(df$change_score)
# Calculate the standard deviation of change score
sd_change <- sd(df$change_score)
# Calculate the number of participants
n <- nrow(df)
# Calculate Z-value using the formuala
z_value <- (mean_change - 0) / (sd_change / sqrt(n))
# Calculate p-value using the Z distribution
p_value <- 2 * (1 - pnorm(abs(z_value)))
# Calculate the Confidence Interval around the mean
error_margin <- qnorm(0.975) * (sd_change / sqrt(n))
# Calculate the Lower limits of the CI
ci_lower <- mean_change - error_margin
# Calculate the Upper limits of the CI
ci_upper <- mean_change + error_margin
# Create a table for the results
data.frame(Mean_Change = round(mean_change, 2), Z_Value = round(z_value, 2), P_Value = round(p_value, 4), CI_Lower = round(ci_lower, 2), CI_Upper = round(ci_upper, 2))

# Interpretation: 
# The average change in AQ scores across all participants showed a positive value (9.77) meaning that scores decreased after treatment and that participants improved

# The Z score of 19.72 shows that the well above 0 and indicates that improvement is highly unlikely random

# P value is 0, so can reject null hypothesis

# 95% Confidence Interval of lower as 8.8 and upper limits at 10.74 shows that the true average improvement is narrow and shows consistent treatment effect

```


#### **Probability**

#### **Hypothesis Testing**

#### **Regresssion Analysis**

#### **Confidence Interval**

```{r}

```

### **Statistical tests**

### **Hypothesis 1 -**

### **Hypothesis 2 -**

### **Hypothesis 3 -**

### **Magnitude and direction of results**

# Discussion

**This is from the brief**
"The Autism Spectrum Quotient (AQ) is a 50-item self report questionnaire with a total score between 0 and 50.1. A higher score indicates a greater number of autistic traits. A total score os 26 or higher is often used as a threshold to suggest the presence of clinically significant autistic traits. Research indicates that the majority of individuals with the official autism diagnosis score 32 or above. In contrast, the average score for neurotypical males is around 17 and for neurotypical females is about 15.6 with males tending to score higher than females in the general population"

### Outline findings and relation to the hypothesis

**Paired t-test results**
Paired t-tests were conducted to examine within-group changes in AQ scores across the 12-week intervention period. The CBT group demonstrated a statistically significant reduction in AQ scores, with a mean decrease of 10.99 points (t = 22.9, p < .001). The VR therapy group showed an even larger and more consistent improvement, with a mean reduction of 18.62 points (t = 37.6, p < .001). In contrast, the control group exhibited no significant change over time (mean difference = 0.6; t = 1.59, p = 0.115). These findings support the hypothesis that both CBT and VR therapy reduce AQ scores, while no improvement occurs without intervention.

**Between group t-test results**

Between-group comparisons further demonstrated that both treatment conditions were significantly more effective than the control group. Participants receiving VR therapy showed substantially greater improvement than controls (t = −28.95, p < .001), as did those receiving CBT (t = 16.35, p < .001). Direct comparison between the two interventions revealed that VR therapy produced significantly greater reductions in AQ scores than CBT (t = −12.38, p < .001), indicating superior effectiveness of the VR-based intervention.

**z-test results**

A z-test assessing overall change across all participants indicated a significant mean reduction in AQ scores of 9.77 points (z = 19.72, p < .001). The 95% confidence interval (8.8 to 10.74) was narrow, suggesting a consistent treatment effect across the sample. This result confirms that the observed improvements were highly unlikely to be due to chance.

Overall, the findings provide strong evidence that both CBT and VR-based therapy significantly reduce AQ scores, with VR therapy yielding the largest and most consistent improvements. CBT also produced meaningful benefits relative to no treatment, while the control group showed no significant change. These results support the study hypotheses and highlight the potential of immersive VR therapy as an effective intervention for reducing autistic traits.

#### Limitations

These findings must be considered with limitations including (dependency on However, the implications are constrained by (over) reliance on self-report data and the need to interpret statistical significance cautiously when considering real-world or clinical impact.

------------------------------------------------------------------------

# References

Ekman E. & Hiltunen A. J. (2015). Modified CBT using visualization for Autism Spectrum Disorder (ASD), anxiety and avoidance behavior – a quasi-experimental open pilot study. Scandinavian Journal of Psychology, 56, 641–648.

Maskey, M., Rodgers, J., Ingham, B., Freeston, M., Evans, G., Labus, M. and Parr, J.R. (2019). Using Virtual Reality Environments to Augment Cognitive Behavioral Therapy for Fears and Phobias in Autistic Adults. Autism in Adulthood, 1(2), pp.134–145. doi:https://doi.org/10.1089/aut.2018.0019.

De Luca, R., Leonardi, S., Portaro, S., Le Cause, M., De Domenico, C., Colucci, P.V., Pranio, F., Bramanti, P. and Calabrò, R.S. (2019). Innovative use of virtual reality in autism spectrum disorder: A case-study. Applied Neuropsychology: Child, 10(1), pp.90–100. doi:https://doi.org/10.1080/21622965.2019.1610964.

Herrero, J.F., Lorenzo, G. An immersive virtual reality educational intervention on people with autism spectrum disorders (ASD) for the development of communication skills and problem solving. Educ Inf Technol 25, 1689–1722 (2020). https://doi-org.mtu.idm.oclc.org/10.1007/s10639-019-10050-0

World Health Organization. (2025). Autism. World Health Organization. https://www.who.int/news-room/fact-sheets/detail/autism-spectrum-disorders