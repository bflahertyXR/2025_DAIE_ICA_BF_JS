---
title: "Comparing the Effectiveness of VR-Based and CBT Interventions for Autism Spectrum
  Disorder"
author: "Brendan Flaherty (D00285274) & Jeremiah Spillane (D00295490)"
date: '`r Sys.Date()`'
output:
  html_document:
    toc: true
    code_folding: hide
    df_print: paged
  html_notebook:
    toc: true
  pdf_document:
    toc: true
  word_document:
    toc: true
---

------------------------------------------------------------------------

# Abstract 
## Aim and rationale 

This research paper examines changes in Autism Spectrum Quotient (AQ) scores across two parameters. Firstly across time, that is pre-treatment and post-treatment over a 12 week period, and secondly, across three groups employing various approaches. The different approaches employed are: 1) cognitive behavioral therapy (CBT), 2) virtual reality (VR), and 3) a control group. This study aims to answer whether CBT or VR-based therapy lead to any statistically significant change in AQ scores compared to no treatment, and whether or not one intervention is more effective than the other.

## Participants and setting 

The study involved a total of 300 adult participants (150 male, 150 female) aged between 12 and 40 years. Participants were randomly sampled from a clinical population and randomly assigned to one of three equal sized groups: a Cognitive Behavioral Therapy (CBT) group, a Virtual Reality (VR) therapy group, and a control group receiving no intervention.

## Experiment design 

This study employed a randomised controlled, pre-test/post AQ tests, mixed experimental design to examine the effectiveness of therapeutic interventions on autistic traits over time (t = 12 weeks).

## Results gathering

Results were gathered by comparing pre- and post-treatment Autism Spectrum Quotient (AQ) scores across participants using these statistical tests, including paired t-tests, between group t-tests, and z-tests, alongside descriptive statistics and 95% confidence intervals to quantify change over the 12-week period. This approach assessed whether observed changes in AQ scores were statistically significant.

## Findings/implications

The findings indicated a statistically notable reduction in AQ scores, suggesting that therapeutic intervention was associated with a measurable change in reported autistic traits across the sample. However, the implications are limited by reliance on self report data and the need to interpret statistical significance cautiously when considering real world or clinical impact.

------------------------------------------------------------------------

# Introduction

## Topic and Context

As defined by the World Health Organisation (WHO) "Autism spectrum disorders (ASD) are a diverse group of conditions. They are characterized by some degree of difficulty with social interaction and communication. Other characteristics are atypical patterns of activities and behaviors, such as difficulty with transition from one activity to another, a focus on details and unusual reactions to sensations". Additionally, it has been suggested that "Cognitive Behavior Therapy (CBT) is beneficial to people with Autism Spectrum Disorder (ASD) but that the method needs to be modified in relation to their cognitive profile" (Ekman E., et al., 2015). Virtual reality (VR) too has been proposed to support those with ASD in educational settings, with emotional regulation and more (Herrero, J.F. et al., 2025). 


## Rationale

This research paper examines changes in Autism Spectrum Quotient (AQ) scores across two parameters. Firstly across time, that is pre-treatment and post-treatmnet over a 12 week period, and secondly, across three groups employing various approaches. These groups employ different approaches, namely 1) cognitive behavioral therapy (CBT) ; 2) virtual reality (VR) and 3) a control group. This study aims to answer whether CBT or VR-based therapy lead to a statistically significant change in AQ scores compared to no treatment, and whether or not one intervention is more effective than the other.

## Hypotheses

Hypothesis 1: After controlling for baseline AQ, there will be no group differences in post-treatment (null-hypothesis).

Hypothesis 2: Both CBT and VR therapy groups will show significant reductions in AQ scores from pre-treatment to post-treatment, while the control group will not.

Hypothesis 3: The VR therapy group will show a statistically significantly greater reduction in AQ scores from pre-treatment to post-treatment than the CBT group.

# Method

## Design

There are several methods for assessing autistic traits, including structured interviews and self-report questionnaires. In this experiment, the severity of autistic traits was assessed using self-report mechanisms. The Autism Spectrum Quotient (AQ) was employed.

## Materials

The AQ questionnaire is is a 50-item self-report questionnaire with a total score ranging from 0 to 50. A higher score indicates a greater number of autistic traits. The original scoring system gives one point for each answer that aligns with an autistic trait, regardless of the strength of agreement ("slightly agree" or "definitely agree"). AQ measurements were collected at baseline and after a 12-week study period.

## Procedure

Participants assigned to the CBT group received weekly 50-minute therapy sessions focused on emotional and social regulation. Participants in the VR therapy group engaged in weekly 50-minute VR-based sessions designed to simulate real-world social interactions in a controlled and immersive environment. The control group did not receive any therapeutic intervention during the study period. AQ scores were collected from all participants at the beginning of the study (pre-treatment) and again after 12 weeks (post-treatment).

# Results

```{r Data Cleaning, message=TRUE, warning=TRUE, paged.print=FALSE}
# Adding librarys to notebook to run the code correctly
if(!require("tidyverse"))
  install.packages("tidyverse")
  library(tidyverse)

if(!require("ggpubr"))
  install.packages("ggpubr")
  library(ggpubr)

if(!require("rstatix"))
  install.packages("rstatix")
  library(rstatix)

if(!require("knitr"))
install.packages("knitr")
library(knitr)


# Read the data frames of the .csv file
df <- read_csv("CA1_Autism_VR_Study_Data_Final.csv")
# Check the column names
colnames(df)
# Change column names to lowercase
df <- df %>% rename_with(tolower) %>% mutate(group = str_trim(tolower(group)))
# Inspect Structure
glimpse(df)
summary(select(df, p1_pre_score, p2_post_score))
# Check for missing values
sapply(df, function(x) sum(is.na(x)))
# Check for values outside the scope of the questionnaire - 0 - 50.1
filter(df, p1_pre_score < 0 | p1_pre_score > 50.1 | p2_post_score < 0 | p2_post_score > 50.1)
# Drop incomplete rows
df <- df %>% drop_na(p1_pre_score, p2_post_score)
# Identify change_score (pre-post AQ)
df <- df %>% mutate(change_score = p1_pre_score - p2_post_score)
# Confirm groups
unique(df$group)
# Check for summary of all columns
summary(select(df, p1_pre_score, p2_post_score, change_score))
```

### Descriptive Statistics

```{r box plot, message=TRUE, warning=TRUE}
# BoxPlot created to show pre-treatment AQ scores
pre_box <- ggplot(df, aes(x = group, y = p1_pre_score, fill = group)) + geom_boxplot() + scale_fill_manual(values = c("skyblue", "lightgreen", "orange")) + labs(title = "Pre-Treatment AQ Scores",  x = "Group", y = "AQ Score (0–50)") + theme_minimal(base_size = 13) + theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# BoxPlot created to show post-treatment AQ scores
post_box <- ggplot(df, aes(x = group, y = p2_post_score, fill = group)) + geom_boxplot() + scale_fill_manual(values = c("skyblue", "lightgreen", "orange")) + labs(title = "Post-Treatment AQ Scores",  x = "Group", y = "AQ Score (0–50)") + theme_minimal(base_size = 13) + theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# Use ggpbr library to arrange histograms side-by-side to show difference pre and post treatment
library(ggpubr)
ggarrange(pre_box, post_box, ncol = 2, common.legend = TRUE, legend = "bottom")

# Pre-treatment AQ scores shows similar median. Post-Treatment AQ scores show VR Therapy group noticeably lower indicating greater improvement. Boxes show IQR and whiskers show outliers

```

```{r bar chart, message=TRUE, warning=TRUE}
# Summarise and group mean score data by group for creating bar chart
avg_dep_scores <- df %>% summarise(mean_pre = mean(p1_pre_score), mean_post = mean(p2_post_score), .by = group) %>% pivot_longer(cols = c(mean_pre, mean_post), names_to = "time", values_to = "mean_score") %>% mutate(time = recode(time, "mean_pre" = "Pre-Treatment", "mean_post" = "Post-Treatment"))

# Bar chart created to show mean AQ scores before and after treatment for each group
ggplot(avg_dep_scores, aes(x = group, y = mean_score, fill = time)) + geom_bar(stat = "identity", position = position_dodge()) + scale_fill_manual(values = c("orange", "skyblue")) + labs(title = "Average AQ (Depression) Scores by Group", x = "Therapy Group", y = "Mean AQ Score (0-50)" ) + theme_minimal(base_size = 13)

# Both CBT and VR Therapy groups show reduced mean AQ scores after treatment
```

```{r line-graph, message=TRUE, warning=TRUE}
# Summarise and group mean score data by time for creating line graph
avg_dep_time <- df %>% summarise(mean_pre = mean(p1_pre_score), mean_post = mean(p2_post_score), .by = group) %>% pivot_longer(cols = c(mean_pre, mean_post), names_to = "time", values_to = "mean_score") %>% mutate(time = recode(time, "mean_pre" = "Pre-Treatment", "mean_post" = "Post-Treatment"))

# Line graph showing mean AQ scores for each group pre and post treatment
ggplot(avg_dep_time, aes(x = time, y = mean_score, group = group, color = group)) + geom_line(linewidth = 1.2) + geom_point(size = 13) + scale_colour_manual(values = c("orange", "skyblue", "lightgreen")) + labs(title = "Change in Mean AQ Scores Over Time by Group", x = "Time Point", y = "Mean AQ Score (0-50)" ) + theme_minimal(base_size = 13)

# Both CBT and VR Therapy groups downward trends from pre-treatment to post-treatment - VR Therapy shows greater reduction 
```

```{r histograms, message=TRUE, warning=TRUE}
# Calculate pre-treatment AQ score distributions across the 3 groups
pre_hist <- ggplot(df, aes(x = p1_pre_score, fill = group)) + geom_histogram(binwidth = 2, alpha = 0.6, position = "identity", color = "black") + geom_vline(data = df %>% group_by(group) %>% summarise(mean_pre = mean(p1_pre_score)), aes(xintercept = mean_pre, colour = group), linetype = "dashed", linewidth = 1) +scale_fill_manual(values = c("orange", "skyblue", "lightgreen")) + scale_colour_manual(values = c("orange", "skyblue", "lightgreen")) + labs(title = "Pre-Treatment AQ Score Distribution", x = "AQ Score (0 -50)", y = "Frequency") + theme_minimal(base_size = 10) + theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# Calculate post-treatment AQ score distributions across the 3 groups
post_hist <- ggplot(df, aes(x = p2_post_score, fill = group)) + geom_histogram(binwidth = 2, alpha = 0.7, colour = "black") + geom_vline(data = df %>% group_by(group) %>% summarise(mean_post = mean(p2_post_score)), aes(xintercept = mean_post, color = group), linetype = "dashed", linewidth = 1) + scale_fill_manual(values = c("orange", "skyblue", "lightgreen")) + scale_colour_manual(values = c("orange", "skyblue", "lightgreen")) + labs(title = "Post-Treatment AQ Score Distribution", x = "AQ Score (0-50)", y = "Frequency") + theme_minimal(base_size = 10) + theme(plot.title = element_text(hjust = 0.5, face = "bold"))

# Use ggpbr library to arrange histograms side-by-side to show difference pre and post treatment
library(ggpubr)
ggarrange(pre_hist, post_hist, ncol = 2, common.legend = TRUE, legend = "bottom")

# All groups show similar AQ score pre-treatment. Post-treatment, both CBT and VR Therapy groups show lower AQ score indicating improvement
```

```{r scatterplot, message=TRUE, warning=TRUE}

# Scatterplot showing relationship between pre-treatment AQ scores and change in AQ scores post-treatment
ggplot(df, aes(x = p1_pre_score, y = change_score, colour = group)) + geom_point(size = 3, alpha = 0.7) + geom_smooth(method = "lm", se = FALSE, linetype = "dashed") + scale_colour_manual(values = c("orange", "skyblue", "lightgreen")) + labs(title = "Pre-Treatment AQ vs Change in Score", x = "Pre-Treatment AQ Score", y = "Change in AQ (Pre - Post, Positive = Improvement)" ) + theme_minimal()

# A positive change indicates improvement - Participants with higher pre-treatment AQ scores tended to have a larger improvement

```

### Magnitude and direction of results

### Statistical tests

### Inferential Statistics

### Hypothesis 1
#### Paired t-test results

Paired t-tests were conducted to examine within-group changes in AQ scores across the 12-week intervention period. The CBT group demonstrated a statistically significant reduction in AQ scores, with a mean decrease of 10.09 points (t = 22.9, p < .001). The VR therapy group showed an even larger and more consistent improvement, with a mean reduction of 18.62 points (t = 37.6, p < .001). In contrast, the control group exhibited no significant change over time (mean difference = 0.6; t = 1.59, p = 0.115). These findings support the hypothesis that both CBT and VR therapy reduce AQ scores, while no improvement occurs without intervention.

```{r paired t-test, message=TRUE, warning=TRUE}
# Assign and filter by group
cbt <- df %>% filter(group == "cbt")
vr <- df %>% filter(group == "vr")
control <- df %>% filter (group == "control")

# t-test by group
t_cbt <- t.test(cbt$p1_pre_score, cbt$p2_post_score, paired = TRUE)
t_vr <- t.test(vr$p1_pre_score, vr$p2_post_score, paired = TRUE)
t_control <- t.test(control$p1_pre_score, control$p2_post_score, paired = TRUE)

# Output results of t-tests in list
list(CBT = t_cbt, VR = t_vr, CONTROL = t_control)


```

### Hypothesis 2
#### Between group t-test results

Between-group comparisons further demonstrated that both treatment conditions were significantly more effective than the control group. Participants receiving VR therapy showed substantially greater improvement than controls (t = −28.95, p < .001), as did those receiving CBT (t = 16.35, p < .001). Direct comparison between the two interventions revealed that VR therapy produced significantly greater reductions in AQ scores than CBT (t = −12.38, p < .001), indicating superior effectiveness of the VR-based intervention.

```{r Between group t-test, message=TRUE, warning=TRUE}
# Assign and filter by groups - VR & Control, CBT & Control, VR and CBT
vr_control <- df %>% filter(group %in% c("vr", "control"))
cbt_control <- df %>% filter(group %in% c("cbt", "control"))
vr_cbt <- df %>% filter(group %in% c("vr", "cbt"))

# t-test between groups - VR vs Control | CBT vs Control | VR vs CBT 
t_vr_control <- t.test(change_score ~ group, data = vr_control, var.equal = TRUE)
t_cbt_control <- t.test(change_score ~ group, data = cbt_control, var.equal = TRUE)
t_vr_cbt <- t.test(change_score ~ group, data = vr_cbt, var.equal = TRUE)

# Output results of between group t-tests in list
list(VR_vs_CONTROL = t_vr_control, CBT_vs_CONTROL = t_cbt_control, VR_vs_CBT = t_vr_cbt)


```

### Hypothesis 3
#### z-test results

A z-test assessing overall change across all participants indicated a significant mean reduction in AQ scores of 9.77 points (z = 19.72, p < .001). The 95% confidence interval (8.8 to 10.74) was narrow, suggesting a consistent treatment effect across the sample. This result confirms that the observed improvements were highly unlikely to be due to chance.

```{r z-test, message=TRUE, warning=TRUE}
# Calculate the sample mean of change score
mean_change <- mean(df$change_score)
# Calculate the standard deviation of change score
sd_change <- sd(df$change_score)
# Calculate the number of participants
n <- nrow(df)
# Calculate Z-value using the formuala
z_value <- (mean_change - 0) / (sd_change / sqrt(n))
# Calculate p-value using the Z distribution
p_value <- 2 * (1 - pnorm(abs(z_value)))
# Calculate the Confidence Interval around the mean
error_margin <- qnorm(0.975) * (sd_change / sqrt(n))
# Calculate the Lower limits of the CI
ci_lower <- mean_change - error_margin
# Calculate the Upper limits of the CI
ci_upper <- mean_change + error_margin
# Create a table for the results
data.frame(Mean_Change = round(mean_change, 2), Z_Value = round(z_value, 2), P_Value = round(p_value, 4), CI_Lower = round(ci_lower, 2), CI_Upper = round(ci_upper, 2))

```
# Discussion

Overall, the findings provide strong evidence that both CBT and VR-based therapy significantly reduce AQ scores, with VR therapy yielding the largest and most consistent improvements, while the control group showed no significant change. These results support the study hypotheses and highlight the potential of immersive VR therapy as an effective intervention for reducing autistic traits. The findings indicated a statistically notable reduction in AQ scores, suggesting that therapeutic intervention was associated with a measurable change in reported autistic traits across the sample.

#### Limitations

These findings must be considered with limitations which include, and are not limited to, (over-)reliance on self-report data and the need to interpret statistical significance cautiously when considering real-world or clinical cases. It is important to note, that the AQ questionnaire is a screening tool and not a diagnostic instrument, a total score of 26 or higher is often used as a threshold to suggest the presence of clinically significant autistic traits. Research indicates that the majority of individuals with an official autism diagnosis score 32 or above. In contrast, the average score for neurotypical males is around 17, and for neurotypical females, it is about 15.6 It is also important to note that, on average, males tend to score slightly higher than females in the general population.

------------------------------------------------------------------------

# References

Baus, Oliver & Bouchard, Stéphane. (2014). Moving from Virtual Reality Exposure-Based Therapy to Augmented Reality Exposure-Based Therapy: A Review. Frontiers in human neuroscience. 8. 112. 10.3389/fnhum.2014.00112. (Accessed: 3 October 2023)

Ekman E. & Hiltunen A. J. (2015). Modified CBT using visualization for Autism Spectrum Disorder (ASD), anxiety and avoidance behavior – a quasi-experimental open pilot study. Scandinavian Journal of Psychology, 56, 641–648.

Freeman, D. et al. (2017) Virtual reality in the assessment, understanding, and treatment of mental health disorders: Psychological medicine, Cambridge Core (Accessed: 6 October 2023)

Maples-Keller, J. L., Bunnell, B. E., Kim, S. J., & Rothbaum, B. O. (2017). The Use of Virtual Reality Technology in the Treatment of Anxiety and Other Psychiatry Disorders. Harvard Review of Psychiatry, 25(3), 103-113. (Accessed: 4 October 2023)

Maskey, M., Rodgers, J., Ingham, B., Freeston, M., Evans, G., Labus, M. and Parr, J.R. (2019). Using Virtual Reality Environments to Augment Cognitive Behavioral Therapy for Fears and Phobias in Autistic Adults. Autism in Adulthood, 1(2), pp.134–145. doi:https://doi.org/10.1089/aut.2018.0019.

De Luca, R., Leonardi, S., Portaro, S., Le Cause, M., De Domenico, C., Colucci, P.V., Pranio, F., Bramanti, P. and Calabrò, R.S. (2019). Innovative use of virtual reality in autism spectrum disorder: A case-study. Applied Neuropsychology: Child, 10(1), pp.90–100. doi:https://doi.org/10.1080/21622965.2019.1610964.

Herrero, J.F., Lorenzo, G. An immersive virtual reality educational intervention on people with autism spectrum disorders (ASD) for the development of communication skills and problem solving. Educ Inf Technol 25, 1689–1722 (2020). https://doi-org.mtu.idm.oclc.org/10.1007/s10639-019-10050-0

World Health Organization. (2025). Autism. World Health Organization. https://www.who.int/news-room/fact-sheets/detail/autism-spectrum-disorders